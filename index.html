<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Digit Extract + 28x28 Normalize (Stable)</title>
<style>
  body { font-family: sans-serif; }
  #digits canvas {
    margin: 4px;
    border: 1px solid #ccc;
  }
</style>
</head>

<body>
<h2>Digit Extract + 28x28 Normalize (Stable)</h2>

<input type="file" id="fileInput" accept="image/*"><br><br>
<div id="log"></div>
<div id="digits"></div>

<!-- OpenCV.js -->
<script src="https://docs.opencv.org/4.x/opencv.js"></script>

<script>
document.addEventListener("DOMContentLoaded", async ()=>{
    const fileInput = document.getElementById("fileInput");
    const logDiv = document.getElementById("log");
    const digitsDiv = document.getElementById("digits");

    function log(text){
        logDiv.innerHTML += text + "<br>";
    }

    // OpenCVロード完了を待つ
    await new Promise(resolve=>{
        cv['onRuntimeInitialized']=()=>{
            log("✔ OpenCV.js ready!");
            resolve();
        };
    });

    fileInput.addEventListener("change", (e)=>{
        const file = e.target.files[0
